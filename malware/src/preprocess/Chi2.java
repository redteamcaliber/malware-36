package preprocess;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

public class Chi2 {

	public static void main(String[] args) {

		try {
			//
			BufferedReader br = new BufferedReader(new FileReader("/home/batu/fs2.txt"));
			String line = br.readLine();

			Map<String, Integer> subList = new HashMap<String, Integer>();
			int threshold = 0;
			while (line != null && threshold < 10000) {
				threshold++;
				subList.put(line.split(",")[0], 0);
				// subList.put(line,0);
				line = br.readLine();
			}
			br.close();
			System.out.println(subList);
			//
			String[] tow = new String[10873];
			BufferedWriter wr = new BufferedWriter(new FileWriter("/home/batu/test12.arff"));
			br = new BufferedReader(new FileReader("/home/batu/test1-23.arff"));
			line = br.readLine();
			wr.write(line + "\n");
			line = br.readLine();
			wr.write(line + "\n");
			line = br.readLine();
			wr.write(line + "\n");
			line = br.readLine();
			int ff = 0;
			Map<String, Integer> use = new HashMap<String, Integer>();
			while (line != null) {
				if (line.startsWith("@attribute Class")) {
					break;
				} else if (subList.containsKey(line.split(" ")[1])) {
					// System.out.println(line.split(" ")[1]+ff);
					use.put(line.split(" ")[1], ff);
					wr.write("@attribute " + line.split(" ")[1] + " numeric\n");
				}
				ff++;
				line = br.readLine();
			}
			line = br.readLine();
			line = br.readLine();
			line = br.readLine();
			line = br.readLine();

			String[] parts;
			int index = 0;
			while (line != null) {
				tow[index] = "";
				System.out.println(index);
				parts = line.split(",");
				tow[index] += parts[0] + ",";
				int i;
				for (i = 0; i < parts.length - 2; i++) {
					if (use.containsValue(i)) {
						tow[index] += parts[i + 1] + ",";// without normalize
					}
				}
				line = br.readLine();
				index++;
			}
			br.close();
			//

			br = new BufferedReader(new FileReader("/home/batu/test2-50.arff"));
			line = br.readLine();
			line = br.readLine();
			line = br.readLine();
			line = br.readLine();
			ff = 0;
			use = new HashMap<String, Integer>();
			while (line != null) {
				if (line.startsWith("@attribute Class")) {
					break;
				} else if (subList.containsKey(line.split(" ")[1])) {
					// System.out.println(line.split(" ")[1]+ff);
					use.put(line.split(" ")[1], ff);
					wr.write("@attribute " + line.split(" ")[1] + " numeric\n");
				}
				ff++;
				line = br.readLine();
			}

			line = br.readLine();
			line = br.readLine();
			line = br.readLine();
			line = br.readLine();

			index = 0;
			while (line != null) {
				System.out.println(index);
				parts = line.split(",");
				// wr.write(parts[0] + ",");
				int i;
				for (i = 0; i < parts.length - 2; i++) {
					if (use.containsValue(i)) {
						tow[index] += parts[i + 1] + ",";// without normalize
					}
				}
				tow[index] += parts[i + 1] + "\n";
				line = br.readLine();
				index++;
			}
			br.close();
			//
			wr.write("@attribute Class {1,2,3,4,5,6,7,8,9}\n\n@data\n\n");
			for (int i = 0; i < 10873; i++) {
				wr.write(tow[i]);
			}
			wr.close();

		} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

}
