package preprocess;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

public class FeatureSelection {

	public static void main(String[] args) {
		int threshold = 200;

		try {
			BufferedReader br = new BufferedReader(new FileReader("/home/batu/train-newnew4.arff"));
			String line = br.readLine();
			List<String> feature = new ArrayList<String>();
			List<Integer> sum = new ArrayList<Integer>();
			// System.out.println(line);
			line = br.readLine();// System.out.println(line);
			line = br.readLine();// System.out.println(line);
			line = br.readLine();// System.out.println(line);

			while (line != null) {
				if (line.startsWith("@attribute Class")) {
					break;
				} else {
					feature.add(line.split(" ")[1]);// System.out.println(line);
				}
				line = br.readLine();
			}
			line = br.readLine();
			line = br.readLine();
			line = br.readLine();
			line = br.readLine();
			int num = 0;
			int j = 0;
			String[] parts;
			parts = line.split(",");
			for (int i = 0; i < parts.length - 2; i++) {
				sum.add(Integer.parseInt(parts[i + 1]));
			}
			line = br.readLine();
			System.out.println(j);
			j++;
			while (line != null) {
				System.out.println(j);
				j++;
				parts = line.split(",");
				for (int i = 0; i < parts.length - 2; i++) {
					num = sum.get(i);
					sum.set(i, num + Integer.parseInt(parts[i + 1]));
				}
				line = br.readLine();
			}
			// for (int i = 0; i < feature.size(); i++) {
			// System.out.println(feature.get(i) + "," + sum.get(i));
			// }
			br.close();
			// write file
			br = new BufferedReader(new FileReader("/home/batu/train-newnew4.arff"));
			BufferedWriter wr = new BufferedWriter(new FileWriter("/home/batu/train-newnewnew4.arff"));
			line = br.readLine();
			wr.write(line + "\n");
			line = br.readLine();
			wr.write(line + "\n");
			line = br.readLine();
			wr.write(line + "\n");
			line = br.readLine();
			while (line != null) {
				if (line.startsWith("@attribute Class")) {
					break;
				}
				line = br.readLine();
			}
			line = br.readLine();
			line = br.readLine();
			line = br.readLine();
			line = br.readLine();

			for (int i = 0; i < feature.size(); i++) {
				//System.out.println(feature.get(i) + "," + sum.get(i));
				if (sum.get(i) >= threshold) {
					wr.write("@attribute " + feature.get(i) + " numeric\n");
				}
			}

			wr.write("@attribute Class {1,2,3,4,5,6,7,8,9}\n\n@data\n\n");
			j = 0;
			while (line != null) {
				System.out.println(j);
				j++;
				parts = line.split(",");
				wr.write(parts[0] + ",");
				int i;
				for (i = 0; i < parts.length - 2; i++) {
					if (sum.get(i) >= threshold) {
						wr.write(parts[i + 1] + ",");
					}
				}
				wr.write(parts[i + 1]);
				line = br.readLine();
				wr.write("\n");
			}

			br.close();
			wr.close();
			
			
			br = new BufferedReader(new FileReader("/home/batu/test-newnew4.arff"));
			wr = new BufferedWriter(new FileWriter("/home/batu/test-newnewnew4.arff"));
			line = br.readLine();
			wr.write(line + "\n");
			line = br.readLine();
			wr.write(line + "\n");
			line = br.readLine();
			wr.write(line + "\n");
			line = br.readLine();
			while (line != null) {
				if (line.startsWith("@attribute Class")) {
					break;
				}
				line = br.readLine();
			}
			line = br.readLine();
			line = br.readLine();
			line = br.readLine();
			line = br.readLine();

			for (int i = 0; i < feature.size(); i++) {
				//System.out.println(feature.get(i) + "," + sum.get(i));
				if (sum.get(i) >= threshold) {
					wr.write("@attribute " + feature.get(i) + " numeric\n");
				}
			}

			wr.write("@attribute Class {1,2,3,4,5,6,7,8,9}\n\n@data\n\n");
			j = 0;
			while (line != null) {
				System.out.println(j);
				j++;
				parts = line.split(",");
				wr.write(parts[0] + ",");
				int i;
				for (i = 0; i < parts.length - 2; i++) {
					if (sum.get(i) >= threshold) {
						wr.write(parts[i + 1] + ",");
					}
				}
				wr.write(parts[i + 1]);
				line = br.readLine();
				wr.write("\n");
			}

			br.close();
			wr.close();
		} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

}
